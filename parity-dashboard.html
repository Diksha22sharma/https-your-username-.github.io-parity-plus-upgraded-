<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Parity Plus - Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        .card { background: white; border-radius: 0.5rem; padding: 1.5rem; box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1); }
        .kpi-card { background: white; border-radius: 0.5rem; padding: 1.5rem; box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1); }
        .page-content { display: none; }
        .page-content.active { display: block; }
        .nav-tab { cursor: pointer; transition: all 0.2s; }
        .nav-tab.active { background-color: #2563eb; color: white; }
        .nav-tab:not(.active):hover { background-color: #f3f4f6; }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="bg-gradient-to-r from-blue-600 to-purple-600 text-white px-8 py-4">
        <div class="flex items-center justify-between">
            <h1 class="text-2xl font-bold">Parity Plus</h1>
            <div class="flex items-center space-x-2">
                <span class="text-sm">Rate Parity Management System</span>
            </div>
        </div>
    </header>

    <!-- Navigation Tabs -->
    <nav class="bg-white border-b border-gray-200 px-8">
        <div class="flex space-x-1">
            <button onclick="showPage('overview')" id="nav-overview" class="nav-tab active px-6 py-3 font-medium rounded-t-lg">
                <i data-lucide="layout-dashboard" class="w-4 h-4 inline mr-2"></i>Overview
            </button>
            <button onclick="showPage('reports')" id="nav-reports" class="nav-tab px-6 py-3 font-medium rounded-t-lg">
                <i data-lucide="file-text" class="w-4 h-4 inline mr-2"></i>Reports
            </button>
            <button onclick="showPage('test-bookings')" id="nav-test-bookings" class="nav-tab px-6 py-3 font-medium rounded-t-lg">
                <i data-lucide="shopping-cart" class="w-4 h-4 inline mr-2"></i>Test Bookings
            </button>
            <button onclick="showPage('statistics')" id="nav-statistics" class="nav-tab px-6 py-3 font-medium rounded-t-lg">
                <i data-lucide="bar-chart-3" class="w-4 h-4 inline mr-2"></i>Statistics
            </button>
            <button onclick="showPage('settings')" id="nav-settings" class="nav-tab px-6 py-3 font-medium rounded-t-lg">
                <i data-lucide="settings" class="w-4 h-4 inline mr-2"></i>Settings
            </button>
        </div>
    </nav>

    <!-- Main Content Container -->
    <main class="p-8">
        <!-- OVERVIEW PAGE -->
        <div id="page-overview" class="page-content active space-y-6">
            <div>
                <h1 class="text-3xl font-bold text-gray-900 tracking-tight">Overview</h1>
                <p class="text-sm text-gray-500 mt-1">Monitor and action rate parity issues across all channels</p>
            </div>

            <!-- KPI Cards -->
            <div class="grid grid-cols-3 gap-6">
                <!-- Parity Score Card -->
                <div class="kpi-card border-l-4 border-l-blue-500 bg-blue-50/50">
                    <p class="text-xs font-medium text-gray-600 mb-1">Parity Score</p>
                    <div class="flex items-baseline space-x-2 mb-1">
                        <p class="text-2xl font-bold text-gray-900">87.5%</p>
                        <span class="px-2 py-0.5 rounded text-xs font-semibold bg-green-100 text-green-600 border border-green-500">Good</span>
                    </div>
                    <p class="text-xs text-gray-500 mb-3">80/100 instances</p>
                    <div class="grid grid-cols-2 gap-2 mt-3">
                        <div class="p-2 bg-white/60 rounded border border-blue-100">
                            <p class="text-[10px] text-gray-600">OTA</p>
                            <p class="text-sm font-bold text-gray-900">89.2%</p>
                            <p class="text-[10px] text-gray-500">45/50</p>
                        </div>
                        <div class="p-2 bg-white/60 rounded border border-blue-100">
                            <p class="text-[10px] text-gray-600">Meta</p>
                            <p class="text-sm font-bold text-gray-900">85.1%</p>
                            <p class="text-[10px] text-gray-500">35/50</p>
                        </div>
                    </div>
                </div>

                <!-- Win/Loss/Meet Card -->
                <div class="kpi-card border-l-4 border-l-purple-500 bg-purple-50/50">
                    <div class="flex items-center space-x-2 mb-3">
                        <button onclick="setWLMView('loss')" id="wlm-loss" class="px-3 py-1 bg-purple-600 text-white rounded text-xs font-medium">Loss</button>
                        <button onclick="setWLMView('win')" id="wlm-win" class="px-3 py-1 bg-gray-200 text-gray-700 rounded text-xs font-medium">Win</button>
                        <button onclick="setWLMView('meet')" id="wlm-meet" class="px-3 py-1 bg-gray-200 text-gray-700 rounded text-xs font-medium">Meet</button>
                    </div>
                    <p id="wlm-percentage" class="text-2xl font-bold text-red-600 mb-3">35%</p>
                    <div class="grid grid-cols-2 gap-2">
                        <div class="p-2 bg-orange-50 rounded border border-orange-200">
                            <p class="text-[10px] text-orange-700">Rate</p>
                            <p id="wlm-rate-percent" class="text-sm font-bold text-orange-900">35%</p>
                            <p id="wlm-rate-inst" class="text-[10px] text-orange-600">35/100</p>
                        </div>
                        <div class="p-2 bg-red-50 rounded border border-red-200">
                            <p class="text-[10px] text-red-700">Availability</p>
                            <p id="wlm-avail-percent" class="text-sm font-bold text-red-900">30%</p>
                            <p id="wlm-avail-inst" class="text-[10px] text-red-600">30/100</p>
                        </div>
                    </div>
                </div>

                <!-- Revenue Loss Card -->
                <div class="kpi-card border-l-4 border-l-red-500 bg-red-50/50">
                    <p class="text-xs font-medium text-gray-600 mb-1">Revenue Loss</p>
                    <p class="text-2xl font-bold text-red-600">$12.4K</p>
                    <p class="text-xs text-gray-500 mb-3">estimated loss</p>
                    <div class="grid grid-cols-2 gap-2">
                        <div class="p-2 bg-orange-50 rounded border border-orange-200">
                            <p class="text-[10px] text-orange-700">Rate</p>
                            <p class="text-sm font-bold text-orange-900">$7.5K</p>
                            <p class="text-[10px] text-orange-600">18 instances</p>
                        </div>
                        <div class="p-2 bg-red-50 rounded border border-red-200">
                            <p class="text-[10px] text-red-700">Availability</p>
                            <p class="text-sm font-bold text-red-900">$4.9K</p>
                            <p class="text-[10px] text-red-600">12 instances</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Top Violations Panel -->
            <div class="card">
                <div class="flex items-center justify-between mb-4">
                    <div class="flex items-center space-x-3">
                        <i data-lucide="alert-triangle" class="w-5 h-5 text-red-600"></i>
                        <h2 class="text-lg font-semibold text-gray-900">Top Violations - Action Required</h2>
                    </div>
                    <button onclick="toggleViolations()" class="p-1 hover:bg-gray-100 rounded">
                        <i data-lucide="chevron-down" id="violations-icon" class="w-4 h-4"></i>
                    </button>
                </div>
                <div id="violations-content" class="space-y-3">
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <h3 class="text-sm font-medium text-gray-700 mb-2">Top Properties</h3>
                            <div class="space-y-2">
                                <div class="flex items-center justify-between p-2 bg-red-50 rounded">
                                    <span class="text-sm font-medium">Hotel Grand Plaza</span>
                                    <span class="text-xs text-red-600 font-semibold">145 violations</span>
                                </div>
                                <div class="flex items-center justify-between p-2 bg-orange-50 rounded">
                                    <span class="text-sm font-medium">Hotel Luxe</span>
                                    <span class="text-xs text-orange-600 font-semibold">132 violations</span>
                                </div>
                                <div class="flex items-center justify-between p-2 bg-yellow-50 rounded">
                                    <span class="text-sm font-medium">Hotel Premier</span>
                                    <span class="text-xs text-yellow-600 font-semibold">98 violations</span>
                                </div>
                            </div>
                        </div>
                        <div>
                            <h3 class="text-sm font-medium text-gray-700 mb-2">Top Channels</h3>
                            <div class="space-y-2">
                                <div class="flex items-center justify-between p-2 bg-red-50 rounded">
                                    <span class="text-sm font-medium">Booking.com</span>
                                    <span class="text-xs text-red-600 font-semibold">234 violations</span>
                                </div>
                                <div class="flex items-center justify-between p-2 bg-orange-50 rounded">
                                    <span class="text-sm font-medium">Expedia</span>
                                    <span class="text-xs text-orange-600 font-semibold">198 violations</span>
                                </div>
                                <div class="flex items-center justify-between p-2 bg-yellow-50 rounded">
                                    <span class="text-sm font-medium">Google Hotels</span>
                                    <span class="text-xs text-yellow-600 font-semibold">156 violations</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Channel Parity Grid -->
            <div class="card">
                <h2 class="text-lg font-semibold text-gray-900 mb-4">Channel Performance</h2>
                <div class="grid grid-cols-3 gap-4">
                    <div class="p-4 bg-gray-50 rounded-lg border border-gray-200">
                        <div class="flex items-center justify-between mb-2">
                            <span class="font-semibold text-sm">Booking.com</span>
                            <span class="px-2 py-0.5 bg-blue-100 text-blue-700 rounded text-xs">OTA</span>
                        </div>
                        <p class="text-2xl font-bold text-green-600">92%</p>
                        <p class="text-xs text-gray-500">1,234 instances</p>
                        <div class="mt-2 h-2 bg-gray-200 rounded-full overflow-hidden">
                            <div class="h-full bg-green-500" style="width: 92%"></div>
                        </div>
                    </div>
                    <div class="p-4 bg-gray-50 rounded-lg border border-gray-200">
                        <div class="flex items-center justify-between mb-2">
                            <span class="font-semibold text-sm">Expedia</span>
                            <span class="px-2 py-0.5 bg-blue-100 text-blue-700 rounded text-xs">OTA</span>
                        </div>
                        <p class="text-2xl font-bold text-yellow-600">85%</p>
                        <p class="text-xs text-gray-500">987 instances</p>
                        <div class="mt-2 h-2 bg-gray-200 rounded-full overflow-hidden">
                            <div class="h-full bg-yellow-500" style="width: 85%"></div>
                        </div>
                    </div>
                    <div class="p-4 bg-gray-50 rounded-lg border border-gray-200">
                        <div class="flex items-center justify-between mb-2">
                            <span class="font-semibold text-sm">Google Hotels</span>
                            <span class="px-2 py-0.5 bg-purple-100 text-purple-700 rounded text-xs">Meta</span>
                        </div>
                        <p class="text-2xl font-bold text-red-600">78%</p>
                        <p class="text-xs text-gray-500">756 instances</p>
                        <div class="mt-2 h-2 bg-gray-200 rounded-full overflow-hidden">
                            <div class="h-full bg-red-500" style="width: 78%"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Hierarchy View -->
            <div class="card">
                <h2 class="text-lg font-semibold text-gray-900 mb-4">Hierarchy View</h2>
                <div class="space-y-2">
                    <!-- Brand A -->
                    <div class="flex items-center gap-4 p-3 rounded-lg border border-gray-200 bg-white hover:bg-gray-50">
                        <button onclick="toggleHierarchy('brand-a')" class="p-1 hover:bg-gray-200 rounded">
                            <i data-lucide="chevron-down" id="icon-brand-a" class="w-4 h-4 text-gray-600"></i>
                        </button>
                        <i data-lucide="building-2" class="w-4 h-4 text-blue-600"></i>
                        <span class="font-semibold text-sm">Brand A</span>
                        <span class="px-1.5 py-0.5 rounded text-[10px] font-medium bg-blue-100 text-blue-700 border border-blue-200">Brand</span>
                        <div class="flex items-center gap-1">
                            <span class="text-xs text-gray-500">Score:</span>
                            <span class="text-sm font-bold text-green-600">87.5%</span>
                        </div>
                        <div class="flex items-center gap-1">
                            <span class="text-xs text-gray-500">25/100</span>
                            <span class="text-xs text-gray-400">instances</span>
                        </div>
                        <div class="flex-1 h-6 rounded overflow-hidden flex border border-gray-200 min-w-[120px] max-w-[200px]">
                            <div class="bg-yellow-400 flex items-center justify-center" style="width: 20%">
                                <span class="text-[9px] font-bold text-gray-900">20%</span>
                            </div>
                            <div class="bg-green-500 flex items-center justify-center" style="width: 50%">
                                <span class="text-[9px] font-bold text-white">50%</span>
                            </div>
                            <div class="bg-red-500 flex items-center justify-center" style="width: 30%">
                                <span class="text-[9px] font-bold text-white">30%</span>
                            </div>
                        </div>
                        <button class="flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-blue-600 hover:text-blue-700 hover:bg-blue-50 rounded-lg">
                            <i data-lucide="eye" class="w-3.5 h-3.5"></i>
                            <span>View Details</span>
                        </button>
                    </div>
                    <!-- Sub Brand A1 (hidden by default) -->
                    <div id="sub-brand-a1" class="ml-6 mt-2 hidden">
                        <div class="flex items-center gap-4 p-3 rounded-lg border border-gray-200 bg-gray-50 hover:bg-gray-100">
                            <div class="w-6"></div>
                            <i data-lucide="layers" class="w-4 h-4 text-purple-600"></i>
                            <span class="font-semibold text-sm">Sub Brand A1</span>
                            <span class="px-1.5 py-0.5 rounded text-[10px] font-medium bg-purple-100 text-purple-700 border border-purple-200">SubBrand</span>
                            <div class="flex items-center gap-1">
                                <span class="text-xs text-gray-500">Score:</span>
                                <span class="text-sm font-bold text-green-600">89.2%</span>
                            </div>
                            <div class="flex items-center gap-1">
                                <span class="text-xs text-gray-500">12/50</span>
                                <span class="text-xs text-gray-400">instances</span>
                            </div>
                            <div class="flex-1 h-6 rounded overflow-hidden flex border border-gray-200 min-w-[120px] max-w-[200px]">
                                <div class="bg-yellow-400 flex items-center justify-center" style="width: 22%">
                                    <span class="text-[9px] font-bold text-gray-900">22%</span>
                                </div>
                                <div class="bg-green-500 flex items-center justify-center" style="width: 48%">
                                    <span class="text-[9px] font-bold text-white">48%</span>
                                </div>
                                <div class="bg-red-500 flex items-center justify-center" style="width: 30%">
                                    <span class="text-[9px] font-bold text-white">30%</span>
                                </div>
                            </div>
                            <button class="flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-blue-600 hover:text-blue-700 hover:bg-blue-50 rounded-lg">
                                <i data-lucide="eye" class="w-3.5 h-3.5"></i>
                                <span>View Details</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- REPORTS PAGE -->
        <div id="page-reports" class="page-content space-y-6">
            <div class="flex items-center justify-between">
                <h1 class="text-2xl font-bold text-gray-900">Reports</h1>
                <div class="flex items-center space-x-3">
                    <div class="flex items-center space-x-2 bg-gray-100 rounded-lg p-1">
                        <button onclick="setReportView('table')" id="report-table-btn" class="px-3 py-1.5 rounded-md text-sm font-medium bg-white text-blue-600 shadow-sm">
                            <i data-lucide="table" class="w-4 h-4 inline"></i> Table
                        </button>
                        <button onclick="setReportView('calendar')" id="report-calendar-btn" class="px-3 py-1.5 rounded-md text-sm font-medium text-gray-600">
                            <i data-lucide="calendar" class="w-4 h-4 inline"></i> Calendar
                        </button>
                    </div>
                    <button class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center space-x-2">
                        <i data-lucide="download" class="w-4 h-4"></i>
                        <span>Export</span>
                    </button>
                </div>
            </div>

            <!-- Table View -->
            <div id="report-table-view" class="card">
                <div class="overflow-x-auto">
                    <table class="w-full border-collapse">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase border-b">Hotel</th>
                                <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase border-b">Channel</th>
                                <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase border-b">Date</th>
                                <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase border-b">Brand Rate</th>
                                <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase border-b">OTA Rate</th>
                                <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase border-b">Variance %</th>
                                <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase border-b">Severity</th>
                                <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase border-b">Actions</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-200">
                            <tr class="hover:bg-gray-50">
                                <td class="px-4 py-3 text-sm text-gray-900" title="Room: Standard | Meal: Breakfast">Hotel Grand Plaza</td>
                                <td class="px-4 py-3">
                                    <span class="text-sm text-gray-900">Booking.com</span>
                                    <span class="px-2 py-0.5 bg-blue-100 text-blue-700 rounded text-xs ml-2">OTA</span>
                                </td>
                                <td class="px-4 py-3 text-sm text-gray-600">2024-01-15</td>
                                <td class="px-4 py-3 text-sm font-medium">$240.00</td>
                                <td class="px-4 py-3 text-sm">$250.00</td>
                                <td class="px-4 py-3 text-sm font-semibold text-red-600">+4.17%</td>
                                <td class="px-4 py-3">
                                    <span class="px-2 py-1 rounded text-xs font-medium bg-red-100 text-red-800">High</span>
                                </td>
                                <td class="px-4 py-3">
                                    <div class="flex items-center space-x-2">
                                        <button class="p-1.5 text-purple-600 hover:bg-purple-50 rounded" title="Test Booking">
                                            <i data-lucide="book-open" class="w-4 h-4"></i>
                                        </button>
                                        <button class="p-1.5 text-blue-600 hover:bg-blue-50 rounded" title="View Cache">
                                            <i data-lucide="eye" class="w-4 h-4"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            <tr class="hover:bg-gray-50">
                                <td class="px-4 py-3 text-sm text-gray-900" title="Room: Deluxe | Meal: Room Only">Hotel Luxe</td>
                                <td class="px-4 py-3">
                                    <span class="text-sm text-gray-900">Expedia</span>
                                    <span class="px-2 py-0.5 bg-blue-100 text-blue-700 rounded text-xs ml-2">OTA</span>
                                </td>
                                <td class="px-4 py-3 text-sm text-gray-600">2024-01-16</td>
                                <td class="px-4 py-3 text-sm font-medium">$245.00</td>
                                <td class="px-4 py-3 text-sm">$255.00</td>
                                <td class="px-4 py-3 text-sm font-semibold text-yellow-600">+4.08%</td>
                                <td class="px-4 py-3">
                                    <span class="px-2 py-1 rounded text-xs font-medium bg-yellow-100 text-yellow-800">Medium</span>
                                </td>
                                <td class="px-4 py-3">
                                    <div class="flex items-center space-x-2">
                                        <button class="p-1.5 text-purple-600 hover:bg-purple-50 rounded" title="Test Booking">
                                            <i data-lucide="book-open" class="w-4 h-4"></i>
                                        </button>
                                        <button class="p-1.5 text-blue-600 hover:bg-blue-50 rounded" title="View Cache">
                                            <i data-lucide="eye" class="w-4 h-4"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            <tr class="hover:bg-gray-50">
                                <td class="px-4 py-3 text-sm text-gray-900" title="Room: Suite | Meal: Half Board">Hotel Premier</td>
                                <td class="px-4 py-3">
                                    <span class="text-sm text-gray-900">Google Hotels</span>
                                    <span class="px-2 py-0.5 bg-purple-100 text-purple-700 rounded text-xs ml-2">Meta</span>
                                    <span class="text-xs text-gray-500 italic ml-1">via Expedia</span>
                                </td>
                                <td class="px-4 py-3 text-sm text-gray-600">2024-01-17</td>
                                <td class="px-4 py-3 text-sm font-medium">$250.00</td>
                                <td class="px-4 py-3 text-sm">$280.00</td>
                                <td class="px-4 py-3 text-sm font-semibold text-red-600">+12.00%</td>
                                <td class="px-4 py-3">
                                    <span class="px-2 py-1 rounded text-xs font-medium bg-red-100 text-red-800">Critical</span>
                                </td>
                                <td class="px-4 py-3">
                                    <div class="flex items-center space-x-2">
                                        <button class="p-1.5 text-purple-600 hover:bg-purple-50 rounded" title="Test Booking">
                                            <i data-lucide="book-open" class="w-4 h-4"></i>
                                        </button>
                                        <button class="p-1.5 text-blue-600 hover:bg-blue-50 rounded" title="View Cache">
                                            <i data-lucide="eye" class="w-4 h-4"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Calendar View -->
            <div id="report-calendar-view" class="card" style="display: none;">
                <div class="flex items-center justify-between mb-4 pb-4 border-b border-gray-200">
                    <h2 class="text-lg font-semibold text-gray-900">Parity Calendar View</h2>
                    <div class="flex items-center space-x-4">
                        <div class="flex items-center space-x-2">
                            <button onclick="prevDates()" id="prev-dates" class="p-1.5 rounded-lg transition-colors hover:bg-gray-100 text-gray-700">
                                <i data-lucide="chevron-left" class="w-4 h-4"></i>
                            </button>
                            <span id="date-range" class="text-sm text-gray-600 min-w-[120px] text-center">Jan 15 - Jan 28</span>
                            <button onclick="nextDates()" id="next-dates" class="p-1.5 rounded-lg transition-colors hover:bg-gray-100 text-gray-700">
                                <i data-lucide="chevron-right" class="w-4 h-4"></i>
                            </button>
                        </div>
                        <label class="text-sm text-gray-600 flex items-center space-x-2">
                            <span>Highlight Threshold:</span>
                            <input type="number" id="threshold-input" min="0" max="100" value="30" class="w-16 px-2 py-1 border border-gray-300 rounded text-sm" onchange="renderCalendar()">
                            <span class="text-xs text-gray-500">%</span>
                        </label>
                    </div>
                </div>
                <div id="calendar-content" class="space-y-2">
                    <!-- Calendar content will be generated here -->
                </div>
            </div>
        </div>

        <!-- TEST BOOKINGS PAGE -->
        <div id="page-test-bookings" class="page-content space-y-6">
            <div class="flex items-center justify-between">
                <h1 class="text-2xl font-bold text-gray-900">Test Bookings</h1>
                <button class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center space-x-2">
                    <i data-lucide="plus" class="w-4 h-4"></i>
                    <span>New Test Booking</span>
                </button>
            </div>

            <div class="card">
                <div class="overflow-x-auto">
                    <table class="w-full border-collapse">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase border-b">Booking ID</th>
                                <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase border-b">Hotel</th>
                                <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase border-b">Dates</th>
                                <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase border-b">Wholesaler/OTA</th>
                                <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase border-b">Leakage</th>
                                <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase border-b">Violations</th>
                                <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase border-b">Status</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-200">
                            <tr class="hover:bg-gray-50">
                                <td class="px-4 py-3 text-sm font-medium text-gray-900">TB-000001</td>
                                <td class="px-4 py-3 text-sm text-gray-900">Hotel Grand Plaza</td>
                                <td class="px-4 py-3 text-sm text-gray-600">2024-01-15 to 2024-01-18</td>
                                <td class="px-4 py-3 text-sm text-gray-600">Booking.com</td>
                                <td class="px-4 py-3 text-sm font-medium text-red-600">$245.50</td>
                                <td class="px-4 py-3 text-sm">
                                    <span class="text-red-600 font-semibold">3</span> / 8
                                </td>
                                <td class="px-4 py-3">
                                    <span class="px-2 py-1 rounded text-xs font-medium bg-orange-100 text-orange-800 border border-orange-200 flex items-center space-x-1 w-fit">
                                        <i data-lucide="clock" class="w-3 h-3"></i>
                                        <span>Open</span>
                                    </span>
                                </td>
                            </tr>
                            <tr class="hover:bg-gray-50">
                                <td class="px-4 py-3 text-sm font-medium text-gray-900">TB-000002</td>
                                <td class="px-4 py-3 text-sm text-gray-900">Hotel Luxe</td>
                                <td class="px-4 py-3 text-sm text-gray-600">2024-01-16 to 2024-01-19</td>
                                <td class="px-4 py-3 text-sm text-gray-600">Expedia</td>
                                <td class="px-4 py-3 text-sm font-medium text-red-600">$189.20</td>
                                <td class="px-4 py-3 text-sm">
                                    <span class="text-green-600 font-semibold">0</span> / 5
                                </td>
                                <td class="px-4 py-3">
                                    <span class="px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-800 border border-green-200 flex items-center space-x-1 w-fit">
                                        <i data-lucide="check-circle" class="w-3 h-3"></i>
                                        <span>Closed by User</span>
                                    </span>
                                </td>
                            </tr>
                            <tr class="hover:bg-gray-50">
                                <td class="px-4 py-3 text-sm font-medium text-gray-900">TB-000003</td>
                                <td class="px-4 py-3 text-sm text-gray-900">Hotel Premier</td>
                                <td class="px-4 py-3 text-sm text-gray-600">2024-01-17 to 2024-01-20</td>
                                <td class="px-4 py-3 text-sm text-gray-600">Wholesaler A</td>
                                <td class="px-4 py-3 text-sm font-medium text-red-600">$312.75</td>
                                <td class="px-4 py-3 text-sm">
                                    <span class="text-red-600 font-semibold">5</span> / 12
                                </td>
                                <td class="px-4 py-3">
                                    <span class="px-2 py-1 rounded text-xs font-medium bg-orange-100 text-orange-800 border border-orange-200 flex items-center space-x-1 w-fit">
                                        <i data-lucide="clock" class="w-3 h-3"></i>
                                        <span>Open</span>
                                    </span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- STATISTICS PAGE -->
        <div id="page-statistics" class="page-content space-y-6">
            <div class="flex items-center justify-between">
                <h1 class="text-2xl font-bold text-gray-900">Statistics</h1>
                <div class="flex items-center space-x-2">
                    <button onclick="setTimeRange('7d')" id="range-7d" class="px-3 py-1 bg-gray-200 text-gray-700 rounded text-sm">7 Days</button>
                    <button onclick="setTimeRange('30d')" id="range-30d" class="px-3 py-1 bg-blue-600 text-white rounded text-sm">30 Days</button>
                    <button onclick="setTimeRange('90d')" id="range-90d" class="px-3 py-1 bg-gray-200 text-gray-700 rounded text-sm">90 Days</button>
                </div>
            </div>

            <div class="grid grid-cols-2 gap-6">
                <div class="card">
                    <h2 class="text-lg font-semibold text-gray-900 mb-4">Top Hotels by Violations</h2>
                    <div class="space-y-3">
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded">
                            <span class="font-medium">Hotel Grand</span>
                            <span class="text-red-600 font-semibold">145 violations</span>
                        </div>
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded">
                            <span class="font-medium">Hotel Luxe</span>
                            <span class="text-orange-600 font-semibold">132 violations</span>
                        </div>
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded">
                            <span class="font-medium">Hotel Premier</span>
                            <span class="text-yellow-600 font-semibold">98 violations</span>
                        </div>
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded">
                            <span class="font-medium">Hotel Elite</span>
                            <span class="text-yellow-600 font-semibold">87 violations</span>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h2 class="text-lg font-semibold text-gray-900 mb-4">Top Channels by Violations</h2>
                    <div class="space-y-3">
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded">
                            <span class="font-medium">Booking.com</span>
                            <span class="text-red-600 font-semibold">234 violations</span>
                        </div>
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded">
                            <span class="font-medium">Expedia</span>
                            <span class="text-orange-600 font-semibold">198 violations</span>
                        </div>
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded">
                            <span class="font-medium">Google Hotels</span>
                            <span class="text-yellow-600 font-semibold">156 violations</span>
                        </div>
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded">
                            <span class="font-medium">TripAdvisor</span>
                            <span class="text-yellow-600 font-semibold">98 violations</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2 class="text-lg font-semibold text-gray-900 mb-4">Top Violation Reasons</h2>
                <div class="space-y-3">
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded">
                        <span class="font-medium">Rate plan difference</span>
                        <span class="text-red-600 font-semibold">342 violations</span>
                    </div>
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded">
                        <span class="font-medium">Promotion/discount difference</span>
                        <span class="text-orange-600 font-semibold">234 violations</span>
                    </div>
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded">
                        <span class="font-medium">Room or board difference</span>
                        <span class="text-yellow-600 font-semibold">189 violations</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- SETTINGS PAGE -->
        <div id="page-settings" class="page-content space-y-6">
            <div class="flex items-center justify-between">
                <h1 class="text-2xl font-bold text-gray-900">Settings</h1>
                <button class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center space-x-2">
                    <i data-lucide="save" class="w-4 h-4"></i>
                    <span>Save Changes</span>
                </button>
            </div>

            <div class="card">
                <div class="flex items-center space-x-2 mb-6">
                    <i data-lucide="alert-triangle" class="w-5 h-5 text-blue-600"></i>
                    <h2 class="text-lg font-semibold text-gray-900">Severity Thresholds</h2>
                </div>
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Critical Threshold</label>
                        <input type="number" value="95" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">High Threshold</label>
                        <input type="number" value="90" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Medium Threshold</label>
                        <input type="number" value="85" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Low Threshold</label>
                        <input type="number" value="80" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="flex items-center space-x-2 mb-6">
                    <i data-lucide="sliders" class="w-5 h-5 text-blue-600"></i>
                    <h2 class="text-lg font-semibold text-gray-900">Tolerance Settings</h2>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Tolerance Percentage</label>
                    <input type="number" value="5" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                    <p class="text-xs text-gray-500 mt-1">Allowed variance percentage before flagging as violation</p>
                </div>
            </div>
        </div>
    </main>

    <script>
        // Initialize icons
        lucide.createIcons();

        // Page Navigation
        function showPage(pageId) {
            document.querySelectorAll('.page-content').forEach(page => {
                page.classList.remove('active');
            });
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.getElementById(`page-${pageId}`).classList.add('active');
            document.getElementById(`nav-${pageId}`).classList.add('active');
            lucide.createIcons();
        }

        // WLM View Toggle
        function setWLMView(view) {
            const views = ['loss', 'win', 'meet'];
            views.forEach(v => {
                const btn = document.getElementById(`wlm-${v}`);
                if (v === view) {
                    btn.className = 'px-3 py-1 bg-purple-600 text-white rounded text-xs font-medium';
                } else {
                    btn.className = 'px-3 py-1 bg-gray-200 text-gray-700 rounded text-xs font-medium';
                }
            });

            const data = {
                loss: { percent: '35%', ratePercent: '35%', rateInst: '35/100', availPercent: '30%', availInst: '30/100', color: 'text-red-600' },
                win: { percent: '20%', ratePercent: '15%', rateInst: '15/100', availPercent: '18%', availInst: '18/100', color: 'text-orange-600' },
                meet: { percent: '50%', ratePercent: '50%', rateInst: '50/100', availPercent: '52%', availInst: '52/100', color: 'text-green-600' }
            };

            const d = data[view];
            document.getElementById('wlm-percentage').textContent = d.percent;
            document.getElementById('wlm-percentage').className = `text-2xl font-bold ${d.color} mb-3`;
            document.getElementById('wlm-rate-percent').textContent = d.ratePercent;
            document.getElementById('wlm-rate-inst').textContent = d.rateInst;
            document.getElementById('wlm-avail-percent').textContent = d.availPercent;
            document.getElementById('wlm-avail-inst').textContent = d.availInst;
        }

        // Toggle Violations Panel
        function toggleViolations() {
            const content = document.getElementById('violations-content');
            const icon = document.getElementById('violations-icon');
            if (content.style.display === 'none') {
                content.style.display = 'block';
                icon.setAttribute('data-lucide', 'chevron-down');
            } else {
                content.style.display = 'none';
                icon.setAttribute('data-lucide', 'chevron-up');
            }
            lucide.createIcons();
        }

        // Hierarchy Toggle
        function toggleHierarchy(id) {
            const element = document.getElementById(id);
            const icon = document.getElementById(`icon-${id}`);
            if (element.classList.contains('hidden')) {
                element.classList.remove('hidden');
                icon.setAttribute('data-lucide', 'chevron-down');
            } else {
                element.classList.add('hidden');
                icon.setAttribute('data-lucide', 'chevron-right');
            }
            lucide.createIcons();
        }

        // Report View Toggle
        function setReportView(view) {
            const tableView = document.getElementById('report-table-view');
            const calendarView = document.getElementById('report-calendar-view');
            const tableBtn = document.getElementById('report-table-btn');
            const calendarBtn = document.getElementById('report-calendar-btn');
            
            if (view === 'table') {
                tableView.style.display = 'block';
                calendarView.style.display = 'none';
                tableBtn.className = 'px-3 py-1.5 rounded-md text-sm font-medium bg-white text-blue-600 shadow-sm';
                calendarBtn.className = 'px-3 py-1.5 rounded-md text-sm font-medium text-gray-600';
            } else {
                tableView.style.display = 'none';
                calendarView.style.display = 'block';
                tableBtn.className = 'px-3 py-1.5 rounded-md text-sm font-medium text-gray-600';
                calendarBtn.className = 'px-3 py-1.5 rounded-md text-sm font-medium bg-white text-blue-600 shadow-sm';
                renderCalendar();
            }
            lucide.createIcons();
        }

        // Calendar Functions
        let dateOffset = 0;
        const visibleDays = 14;
        const startDate = '2024-01-15';
        const endDate = '2024-01-28';

        function generateDates() {
            const dates = [];
            const start = new Date(startDate);
            const end = new Date(endDate);
            const current = new Date(start);
            while (current <= end) {
                dates.push(current.toISOString().split('T')[0]);
                current.setDate(current.getDate() + 1);
            }
            return dates;
        }

        function renderCalendar() {
            const dates = generateDates();
            const visibleDates = dates.slice(dateOffset, dateOffset + visibleDays);
            const container = document.getElementById('calendar-content');
            const threshold = parseInt(document.getElementById('threshold-input').value) || 30;
            
            const entities = [
                { name: 'Hotel Grand Plaza', type: 'hotel', score: 87.5, wlm: { win: 20, meet: 50, loss: 30, total: 100 } },
                { name: 'Booking.com', type: 'channel', score: 92.0, wlm: { win: 25, meet: 45, loss: 30, total: 100 } },
                { name: 'Expedia', type: 'channel', score: 85.0, wlm: { win: 15, meet: 55, loss: 30, total: 100 } }
            ];

            container.innerHTML = entities.map(entity => {
                const wlmPercentages = {
                    win: (entity.wlm.win / entity.wlm.total) * 100,
                    meet: (entity.wlm.meet / entity.wlm.total) * 100,
                    loss: (entity.wlm.loss / entity.wlm.total) * 100
                };

                return `
                    <div class="flex items-center gap-4 p-3 rounded-lg border border-gray-200 bg-white">
                        <div class="flex items-center gap-2 min-w-0 flex-shrink-0">
                            <span class="font-semibold text-sm">${entity.name}</span>
                            <span class="px-1.5 py-0.5 rounded text-[10px] font-medium bg-blue-100 text-blue-700 border border-blue-200">${entity.type === 'hotel' ? 'Hotel' : 'Channel'}</span>
                        </div>
                        <div class="flex items-center gap-1 flex-shrink-0">
                            <span class="text-xs text-gray-500">Score:</span>
                            <span class="text-sm font-bold text-green-600">${entity.score}%</span>
                        </div>
                        <div class="flex items-center gap-2 flex-1 min-w-0">
                            <div class="h-6 rounded overflow-hidden flex border border-gray-200 flex-1 min-w-[120px] max-w-[200px]">
                                <div class="bg-yellow-400 flex items-center justify-center" style="width: ${wlmPercentages.win}%">
                                    ${wlmPercentages.win > 8 ? `<span class="text-[9px] font-bold text-gray-900">${wlmPercentages.win.toFixed(0)}%</span>` : ''}
                                </div>
                                <div class="bg-green-500 flex items-center justify-center" style="width: ${wlmPercentages.meet}%">
                                    ${wlmPercentages.meet > 8 ? `<span class="text-[9px] font-bold text-white">${wlmPercentages.meet.toFixed(0)}%</span>` : ''}
                                </div>
                                <div class="bg-red-500 flex items-center justify-center" style="width: ${wlmPercentages.loss}%">
                                    ${wlmPercentages.loss > 8 ? `<span class="text-[9px] font-bold text-white">${wlmPercentages.loss.toFixed(0)}%</span>` : ''}
                                </div>
                            </div>
                        </div>
                        <div class="flex items-center gap-1 flex-shrink-0">
                            ${visibleDates.map(date => {
                                const score = 70 + Math.random() * 25;
                                const wlm = score >= 90 ? 'Win' : score >= 75 ? 'Meet' : 'Loss';
                                const color = score >= 90 ? 'bg-green-500' : score >= 75 ? 'bg-yellow-400' : 'bg-red-500';
                                const letter = wlm.charAt(0);
                                const highlight = score < threshold;
                                
                                return `
                                    <div class="w-12 h-10 border border-gray-200 flex flex-col items-center justify-center text-xs rounded ${highlight ? 'bg-red-50 border-red-300' : 'bg-white'}" title="${date}: ${score.toFixed(0)}% (${wlm})">
                                        <div class="w-3 h-3 rounded-full ${color} flex items-center justify-center mb-0.5">
                                            <span class="text-[7px] font-bold text-white">${letter}</span>
                                        </div>
                                        <span class="text-[9px] font-semibold ${score >= 90 ? 'text-green-600' : score >= 75 ? 'text-yellow-600' : 'text-red-600'}">${score.toFixed(0)}%</span>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    </div>
                `;
            }).join('');

            if (visibleDates.length > 0) {
                const start = new Date(visibleDates[0]).toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
                const end = new Date(visibleDates[visibleDates.length - 1]).toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
                document.getElementById('date-range').textContent = `${start} - ${end}`;
            }

            lucide.createIcons();
        }

        function prevDates() {
            dateOffset = Math.max(0, dateOffset - visibleDays);
            renderCalendar();
        }

        function nextDates() {
            const dates = generateDates();
            dateOffset = Math.min(dates.length - visibleDays, dateOffset + visibleDays);
            renderCalendar();
        }

        // Time Range Toggle
        function setTimeRange(range) {
            ['7d', '30d', '90d'].forEach(r => {
                const btn = document.getElementById(`range-${r}`);
                if (r === range) {
                    btn.className = 'px-3 py-1 bg-blue-600 text-white rounded text-sm';
                } else {
                    btn.className = 'px-3 py-1 bg-gray-200 text-gray-700 rounded text-sm';
                }
            });
        }
    </script>
</body>
</html>